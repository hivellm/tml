//! File I/O operations.
//!
//! Provides the [`File`] type for reading and writing files.
//!
//! # Example
//!
//! ```tml
//! use std::file::File
//!
//! let content = File::read_all("config.txt")
//! File::write_all("output.txt", "Hello, World!")
//! ```

/// A file handle for reading and writing operations.
///
/// `File` provides both instance methods for streaming I/O
/// and static methods for simple read/write operations.
///
/// # Example
///
/// ```tml
/// let file = File::open_read("data.txt")
/// let line = file.read_line()
/// file.close()
/// ```
pub type File {
    handle: *Unit
}

impl File {
    /// Open a file for reading
    pub func open_read(path: Str) -> File {
        let h: *Unit = lowlevel { file_open_read(path) }
        File { handle: h }
    }

    /// Open a file for writing (creates or truncates)
    pub func open_write(path: Str) -> File {
        let h: *Unit = lowlevel { file_open_write(path) }
        File { handle: h }
    }

    /// Open a file for appending
    pub func open_append(path: Str) -> File {
        let h: *Unit = lowlevel { file_open_append(path) }
        File { handle: h }
    }

    /// Check if the file is open
    pub func is_open(this) -> Bool {
        let r: Bool = lowlevel { file_is_open(this.handle) }
        return r
    }

    /// Read a single line from the file
    pub func read_line(this) -> Str {
        let r: Str = lowlevel { file_read_line(this.handle) }
        return r
    }

    /// Write a string to the file
    pub func write_str(this, content: Str) -> Bool {
        let r: Bool = lowlevel { file_write_str(this.handle, content) }
        return r
    }

    /// Get the size of the file in bytes
    pub func size(this) -> I64 {
        let r: I64 = lowlevel { file_size(this.handle) }
        return r
    }

    /// Close the file
    pub func close(this) {
        lowlevel { file_close(this.handle) }
    }

    // ========== Static utility functions ==========

    /// Read entire file contents as a string
    pub func read_all(path: Str) -> Str {
        let r: Str = lowlevel { file_read_all(path) }
        return r
    }

    /// Write content to a file (overwrites if exists)
    pub func write_all(path: Str, content: Str) -> Bool {
        let r: Bool = lowlevel { file_write_all(path, content) }
        return r
    }

    /// Append content to a file
    pub func append_all(path: Str, content: Str) -> Bool {
        let r: Bool = lowlevel { file_append_all(path, content) }
        return r
    }
}
