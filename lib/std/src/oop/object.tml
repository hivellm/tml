//! Object base class for TML's class hierarchy.
//!
//! This module provides the root `Object` class that all classes inherit from,
//! following C#'s System.Object pattern.
//!
//! # Main Types
//!
//! | Type | Description |
//! |------|-------------|
//! | [`Object`] | Base class for all TML classes |
//! | [`Objects`] | Static utility methods for object operations |
//!
//! # The Object Class
//!
//! Every class in TML implicitly inherits from `Object` if no explicit base
//! class is specified. `Object` provides fundamental methods:
//!
//! - `equals()` - Check equality by reference or value
//! - `get_hash_code()` - Return a hash code for the object
//! - `to_string()` - Return a string representation
//! - `get_type()` - Return the runtime type name
//!
//! # Example
//!
//! ```tml
//! class Person extends Object {
//!     name: Str
//!
//!     override func to_string(this) -> Str {
//!         return "Person: " + this.name
//!     }
//! }
//!
//! let p = Person { name: "Alice" }
//! print(p.to_string())  // "Person: Alice"
//! ```

use std::oop::interfaces::*

// ============================================================================
// Object
// ============================================================================

/// The base class for all classes in TML.
///
/// All classes inherit from `Object` either directly or indirectly.
/// `Object` provides the fundamental methods that all objects share.
///
/// # Implements
///
/// - [`IEquatable[Object]`] - Type-specific equality comparison
/// - [`IHashable`] - Hash code generation
/// - [`IFormattable`] - String formatting
pub class Object implements IEquatable[Object], IHashable, IFormattable {
    /// Compares this object with another for equality.
    ///
    /// The default implementation checks reference equality.
    /// Subclasses should override this for value equality.
    ///
    /// # Arguments
    /// * `other` - The object to compare with
    ///
    /// # Returns
    /// `true` if the objects are equal, `false` otherwise
    virtual func equals(this, other: Object) -> Bool {
        // Default: reference equality (address comparison)
        // In TML, we compare by checking if both are the same instance
        return false // Base implementation - always false for different instances
    }

    /// Returns a hash code for this object.
    ///
    /// Objects that are equal (according to equals()) should return
    /// the same hash code.
    ///
    /// # Returns
    /// A 64-bit hash code
    virtual func get_hash_code(this) -> I64 {
        // Default implementation returns a constant
        // Subclasses should override with meaningful hash
        return 0
    }

    /// Returns a string representation of this object.
    ///
    /// The default implementation returns the class name.
    /// Subclasses should override for meaningful output.
    ///
    /// # Returns
    /// A string representation of the object
    virtual func to_string(this) -> Str {
        return "Object"
    }

    /// Returns a formatted string representation of this object.
    ///
    /// # Arguments
    /// * `format` - The format string
    ///
    /// # Returns
    /// A formatted string representation
    virtual func to_string_format(this, format: Str) -> Str {
        return this.to_string()
    }

    /// Returns the runtime type name of this object.
    ///
    /// # Returns
    /// The name of the object's runtime type
    virtual func get_type(this) -> Str {
        return "Object"
    }

    /// Checks if this object is the same instance as another.
    ///
    /// # Arguments
    /// * `other` - The object to compare with
    ///
    /// # Returns
    /// `true` if both references point to the same instance
    func reference_equals(this, other: Object) -> Bool {
        // Reference equality check
        return false // Will be overridden or use actual address comparison
    }
}

// ============================================================================
// Objects
// ============================================================================

/// Static utility methods for object operations.
///
/// Provides helper methods that work with any `Object` instance,
/// similar to C#'s `Object` static methods.
///
/// # Example
///
/// ```tml
/// let a = Person { name: "Alice" }
/// let b = Person { name: "Alice" }
///
/// if Objects::equals(a, b) {
///     print("Objects are equal")
/// }
/// ```
pub class Objects {
    /// Checks if two objects are equal, handling null cases.
    ///
    /// # Arguments
    /// * `a` - First object
    /// * `b` - Second object
    ///
    /// # Returns
    /// `true` if both are equal or both are null
    static func equals(a: Object, b: Object) -> Bool {
        return a.equals(b)
    }

    /// Returns the hash code of an object, or 0 if null.
    ///
    /// # Arguments
    /// * `obj` - The object
    ///
    /// # Returns
    /// The hash code, or 0 for null
    static func hash(obj: Object) -> I64 {
        return obj.get_hash_code()
    }

    /// Returns the string representation, or "null" if null.
    ///
    /// # Arguments
    /// * `obj` - The object
    ///
    /// # Returns
    /// String representation, or "null"
    static func to_string(obj: Object) -> Str {
        return obj.to_string()
    }
}
