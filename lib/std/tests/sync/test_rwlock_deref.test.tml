use test
use std::sync::rwlock::RwLock

@test
func test_rwlock_new() -> I32 {
    let mut rw = RwLock::new(42)
    return 0
}

@test
func test_rwlock_read_get() -> I32 {
    let mut rw = RwLock::new(77)
    let guard = rw.read()
    let val = guard.get()
    return 0
}

@test
func test_rwlock_read_deref() -> I32 {
    let mut rw = RwLock::new(77)
    let guard = rw.read()
    let val: I32 = *guard
    assert(val == 77, "read guard deref should return 77")
    return 0
}

@test
func test_rwlock_write_deref() -> I32 {
    let mut rw = RwLock::new(33)
    let mut guard = rw.write()
    let val: I32 = *guard
    assert(val == 33, "write guard deref should return 33")
    return 0
}
