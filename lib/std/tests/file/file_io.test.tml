// Tests for std::file::File I/O operations
use test
use std::file::file::File
use std::file::path::Path

@test
func test_file_write_and_read() -> I32 {
    let test_path: Str = "build/debug/_test_io_tmp.txt"
    let wrote: Bool = File::write_all(test_path, "hello file io")
    assert(wrote, "write_all should succeed")

    let content: Str = File::read_all(test_path)
    assert_eq(content, "hello file io", "read_all should return written content")

    // cleanup
    Path::remove(test_path)
    return 0
}

@test
func test_file_append() -> I32 {
    let test_path: Str = "build/debug/_test_append_tmp.txt"
    File::write_all(test_path, "line1")
    File::append_all(test_path, " line2")

    let content: Str = File::read_all(test_path)
    assert_eq(content, "line1 line2", "append should add to existing content")

    Path::remove(test_path)
    return 0
}

@test
func test_file_open_write_close() -> I32 {
    let test_path: Str = "build/debug/_test_handle_tmp.txt"
    let f: File = File::open_write(test_path)
    assert(f.is_open(), "opened file should be open")
    f.write_str("streamed data")
    f.close()

    let content: Str = File::read_all(test_path)
    assert_eq(content, "streamed data", "should read streamed content")

    Path::remove(test_path)
    return 0
}
