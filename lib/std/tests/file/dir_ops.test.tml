// Tests for std::file::Dir operations
use test
use std::file::dir::Dir
use std::file::path::Path

@test
func test_dir_create_and_remove() -> I32 {
    let dir_path: Str = "build/debug/_test_dir_tmp"
    let created: Bool = Dir::create(dir_path)
    assert(created, "Dir::create should succeed")
    assert(Path::exists(dir_path), "created dir should exist")
    assert(Path::is_dir(dir_path), "should be a directory")

    let removed: Bool = Dir::remove(dir_path)
    assert(removed, "Dir::remove should succeed")
    assert(not Path::exists(dir_path), "removed dir should not exist")
    return 0
}

@test
func test_dir_create_all() -> I32 {
    let dir_path: Str = "build/debug/_test_dir_nested/a/b"
    let created: Bool = Dir::create_all(dir_path)
    assert(created, "Dir::create_all should succeed")
    assert(Path::exists(dir_path), "nested dir should exist")
    assert(Path::is_dir(dir_path), "should be a directory")

    // cleanup nested dirs
    Dir::remove("build/debug/_test_dir_nested/a/b")
    Dir::remove("build/debug/_test_dir_nested/a")
    Dir::remove("build/debug/_test_dir_nested")
    return 0
}

@test
func test_dir_create_existing() -> I32 {
    let dir_path: Str = "build/debug/_test_dir_existing"
    Dir::create(dir_path)
    // Creating again should not fail catastrophically
    let created_again: Bool = Dir::create(dir_path)
    // cleanup
    Dir::remove(dir_path)
    return 0
}
