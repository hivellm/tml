//! Tests for crypto cipher functions

use test::{assert, assert_eq}
use std::crypto::cipher::{CipherAlgorithm}

// ============================================================================
// CipherAlgorithm enum tests
// ============================================================================

@test
func test_cipher_algorithm_name() -> I32 {
    // Test name() method returns correct OpenSSL algorithm names
    assert_eq(CipherAlgorithm::Aes128Cbc.name(), "aes-128-cbc", "AES-128-CBC name")
    assert_eq(CipherAlgorithm::Aes256Cbc.name(), "aes-256-cbc", "AES-256-CBC name")
    assert_eq(CipherAlgorithm::Aes256Gcm.name(), "aes-256-gcm", "AES-256-GCM name")
    assert_eq(CipherAlgorithm::ChaCha20Poly1305.name(), "chacha20-poly1305", "ChaCha20-Poly1305 name")
    assert_eq(CipherAlgorithm::XChaCha20Poly1305.name(), "xchacha20-poly1305", "XChaCha20-Poly1305 name")
    return 0
}

@test
func test_cipher_algorithm_key_size() -> I32 {
    // Test key_size() returns correct byte counts
    assert_eq(CipherAlgorithm::Aes128Cbc.key_size(), 16, "AES-128 key size")
    assert_eq(CipherAlgorithm::Aes192Cbc.key_size(), 24, "AES-192 key size")
    assert_eq(CipherAlgorithm::Aes256Cbc.key_size(), 32, "AES-256 key size")
    assert_eq(CipherAlgorithm::ChaCha20Poly1305.key_size(), 32, "ChaCha20-Poly1305 key size")
    assert_eq(CipherAlgorithm::Des3Cbc.key_size(), 24, "3DES key size")
    return 0
}

@test
func test_cipher_algorithm_iv_size() -> I32 {
    // Test iv_size() returns correct byte counts
    assert_eq(CipherAlgorithm::Aes128Cbc.iv_size(), 16, "AES-CBC IV size")
    assert_eq(CipherAlgorithm::Aes256Gcm.iv_size(), 12, "AES-GCM nonce size")
    assert_eq(CipherAlgorithm::ChaCha20Poly1305.iv_size(), 12, "ChaCha20-Poly1305 nonce size")
    assert_eq(CipherAlgorithm::XChaCha20Poly1305.iv_size(), 24, "XChaCha20-Poly1305 nonce size")
    assert_eq(CipherAlgorithm::Aes256Ecb.iv_size(), 0, "ECB has no IV")
    return 0
}
