// Stack full coverage
use test::{assert, assert_eq}
use std::collections::class_collections::Stack

@test
func test_stack_create() -> I32 {
    let s: Stack[I64] = Stack::create[I64]()
    assert_eq(s.count(), 0 as I64, "new stack should be empty")
    assert(s.is_empty(), "new stack should report is_empty")
    return 0
}

@test
func test_stack_push_pop() -> I32 {
    var s: Stack[I64] = Stack::create[I64]()
    s.push(10)
    s.push(20)
    s.push(30)
    assert_eq(s.count(), 3 as I64, "count should be 3")

    let v1: Maybe[I64] = s.pop()
    assert(v1 == Just(30 as I64), "pop should return 30 (LIFO)")
    let v2: Maybe[I64] = s.pop()
    assert(v2 == Just(20 as I64), "pop should return 20")
    let v3: Maybe[I64] = s.pop()
    assert(v3 == Just(10 as I64), "pop should return 10")

    let v4: Maybe[I64] = s.pop()
    assert(v4 == Nothing, "pop on empty should be Nothing")
    return 0
}

@test
func test_stack_peek() -> I32 {
    var s: Stack[I64] = Stack::create[I64]()
    let empty_peek: Maybe[I64] = s.peek()
    assert(empty_peek == Nothing, "peek on empty should be Nothing")

    s.push(42)
    let p: Maybe[I64] = s.peek()
    assert(p == Just(42 as I64), "peek should return 42")
    assert_eq(s.count(), 1 as I64, "peek should not remove element")
    return 0
}

@test
func test_stack_add() -> I32 {
    var s: Stack[I64] = Stack::create[I64]()
    s.add(10)
    s.add(20)
    assert_eq(s.count(), 2 as I64, "add should push")
    return 0
}

@test
func test_stack_clear() -> I32 {
    var s: Stack[I64] = Stack::create[I64]()
    s.push(1)
    s.push(2)
    s.clear()
    assert_eq(s.count(), 0 as I64, "count after clear should be 0")
    assert(s.is_empty(), "should be empty after clear")
    return 0
}

@test
func test_stack_with_capacity() -> I32 {
    var s: Stack[I64] = Stack::with_capacity[I64](64)
    assert(s.is_empty(), "new stack with capacity should be empty")
    s.push(1)
    assert_eq(s.count(), 1 as I64, "count should be 1")
    return 0
}

@test
func test_stack_contains() -> I32 {
    var s: Stack[I64] = Stack::create[I64]()
    s.push(10)
    s.push(20)
    assert(s.contains(10), "should contain 10")
    assert(s.contains(20), "should contain 20")
    assert(not s.contains(30), "should not contain 30")
    return 0
}

@test
func test_stack_remove() -> I32 {
    var s: Stack[I64] = Stack::create[I64]()
    s.push(10)
    s.push(20)
    s.push(30)
    let removed = s.remove(20)
    assert(removed, "remove(20) should return true")
    assert_eq(s.count(), 2 as I64, "count after remove")
    let not_removed = s.remove(99)
    assert(not not_removed, "remove(99) should return false")
    return 0
}
