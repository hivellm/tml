// Tests for List[T] growth behavior and edge cases
use test::{assert, assert_eq}
use std::collections::List

@test
func test_list_grow_beyond_capacity() -> I32 {
    let list: List[I32] = List[I32].new(2)
    list.push(1)
    list.push(2)
    list.push(3)
    list.push(4)
    list.push(5)
    assert_eq(list.len(), 5 as I64, "list should have 5 elements")
    let v4: I64 = list.get(4)
    assert_eq(v4, 5 as I64, "element beyond initial capacity")
    list.destroy()
    return 0
}

@test
func test_list_push_pop_cycle() -> I32 {
    let list: List[I32] = List[I32].new(4)
    list.push(10)
    list.push(20)
    let a: I64 = list.pop()
    assert_eq(a, 20 as I64, "pop returns 20")
    list.push(30)
    list.push(40)
    assert_eq(list.len(), 3 as I64, "len after push-pop-push-push")
    let b: I64 = list.get(2)
    assert_eq(b, 40 as I64, "last pushed element")
    list.destroy()
    return 0
}

@test
func test_list_set_overwrite() -> I32 {
    let list: List[I32] = List[I32].new(4)
    list.push(0)
    list.push(0)
    list.push(0)
    list.set(0, 100)
    list.set(1, 200)
    list.set(2, 300)
    let v0: I64 = list.get(0)
    let v1: I64 = list.get(1)
    let v2: I64 = list.get(2)
    assert_eq(v0, 100 as I64, "set index 0")
    assert_eq(v1, 200 as I64, "set index 1")
    assert_eq(v2, 300 as I64, "set index 2")
    list.destroy()
    return 0
}
