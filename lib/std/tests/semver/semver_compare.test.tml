use test
use std::semver::Version

@test
func test_compare_major() -> I32 {
    let a = Version::new(1, 0, 0)
    let b = Version::new(2, 0, 0)
    assert_eq(a.compare(b), -1)
    assert_eq(b.compare(a), 1)
    assert_eq(a.compare(a), 0)
    0
}

@test
func test_compare_minor() -> I32 {
    let a = Version::new(1, 2, 0)
    let b = Version::new(1, 3, 0)
    assert_eq(a.compare(b), -1)
    assert_eq(b.compare(a), 1)
    0
}

@test
func test_compare_patch() -> I32 {
    let a = Version::new(1, 2, 3)
    let b = Version::new(1, 2, 4)
    assert_eq(a.compare(b), -1)
    assert_eq(b.compare(a), 1)
    0
}

@test
func test_lt_gt_le_ge() -> I32 {
    let a = Version::new(1, 0, 0)
    let b = Version::new(2, 0, 0)
    assert(a.lt(b), "1.0.0 < 2.0.0")
    assert(b.gt(a), "2.0.0 > 1.0.0")
    assert(a.le(b), "1.0.0 <= 2.0.0")
    assert(a.le(a), "1.0.0 <= 1.0.0")
    assert(b.ge(a), "2.0.0 >= 1.0.0")
    assert(b.ge(b), "2.0.0 >= 2.0.0")
    0
}

@test
func test_prerelease_lower_precedence() -> I32 {
    let a = Version::new_pre(1, 0, 0, "alpha")
    let b = Version::new(1, 0, 0)
    // Pre-release has lower precedence than release
    assert(a.lt(b), "1.0.0-alpha < 1.0.0")
    assert(b.gt(a), "1.0.0 > 1.0.0-alpha")
    0
}

@test
func test_prerelease_comparison() -> I32 {
    let a = Version::new_pre(1, 0, 0, "alpha")
    let b = Version::new_pre(1, 0, 0, "beta")
    // alpha < beta lexicographically
    assert(a.lt(b), "1.0.0-alpha < 1.0.0-beta")
    0
}

@test
func test_prerelease_numeric_comparison() -> I32 {
    let a = Version::new_pre(1, 0, 0, "1")
    let b = Version::new_pre(1, 0, 0, "2")
    assert(a.lt(b), "1.0.0-1 < 1.0.0-2")
    0
}

@test
func test_bump_major() -> I32 {
    let v = Version::new(1, 2, 3)
    let bumped = v.bump_major()
    assert_eq(bumped.major, 2 as I64)
    assert_eq(bumped.minor, 0 as I64)
    assert_eq(bumped.patch, 0 as I64)
    0
}
