//! Additional recursive glob test (standalone).

use std::glob::{Glob, matches}
use std::file::{File, Dir, Path}
use test::{assert, assert_eq}

@test
func test_glob_recursive_deep() -> I32 {
    Dir::create_all("_gt5/x/y/z")
    File::write_all("_gt5/a.txt", "a")
    File::write_all("_gt5/x/b.txt", "b")
    File::write_all("_gt5/x/y/c.txt", "c")
    File::write_all("_gt5/x/y/z/d.txt", "d")

    var g: Glob = Glob::find("_gt5", "**/*.txt")
    let n: I64 = g.count()
    g.free()

    Path::remove("_gt5/a.txt")
    Path::remove("_gt5/x/b.txt")
    Path::remove("_gt5/x/y/c.txt")
    Path::remove("_gt5/x/y/z/d.txt")
    Dir::remove("_gt5/x/y/z")
    Dir::remove("_gt5/x/y")
    Dir::remove("_gt5/x")
    Dir::remove("_gt5")

    assert_eq(n, 4, "should find 4 .txt files in deep tree")
    return 0
}
