//! IP diag2 - test U8 field access with values > 127 (v2 cache bust)

use test::{assert, assert_eq}

type MyStruct {
    a: U8,
    b: U8,
}

@test
func test_u8_struct_field_cast() -> I32 {
    let s = MyStruct { a: 192, b: 168 }
    let a16: U16 = s.a as U16
    let b16: U16 = s.b as U16
    print("a16=" + a16.to_string() + " (expected 192)\n")
    print("b16=" + b16.to_string() + " (expected 168)\n")
    let shifted: U16 = (a16 shl 8) | b16
    print("shifted=" + shifted.to_string() + " (expected 49320)\n")
    assert_eq(a16, 192 as U16, "a should be 192")
    assert_eq(b16, 168 as U16, "b should be 168")
    return 0
}
