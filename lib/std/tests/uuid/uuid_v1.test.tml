use test
use std::uuid::Uuid
use core::str

@test
func test_uuid_v1_version_and_variant() -> I32 {
    let id = Uuid::v1()
    assert_eq(id.version(), 1)
    assert_eq(id.variant(), 2)
    assert(not id.is_nil(), "v1 should not be nil")
    assert_eq(str::len(id.to_string()), 36)
    0
}

@test
func test_uuid_v1_uniqueness() -> I32 {
    let a = Uuid::v1()
    let b = Uuid::v1()
    assert(not a.eq(ref b), "two v1 UUIDs should be different")
    0
}

@test
func test_uuid_v1_timestamp_nonzero() -> I32 {
    let id = Uuid::v1()
    assert(id.timestamp() > 0, "v1 timestamp should be positive")
    0
}

@test
func test_uuid_v1_parse_roundtrip() -> I32 {
    let id = Uuid::v1()
    let s = id.to_string()
    when Uuid::parse(s) {
        Ok(parsed) => {
            assert(id.eq(ref parsed), "roundtrip should preserve UUID")
            assert_eq(parsed.version(), 1)
        }
        Err(e) => assert(false, "parse should succeed")
    }
    0
}
