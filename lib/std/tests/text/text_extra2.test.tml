// Tests for std::text â€” uncovered methods: fill_char, push_formatted, from_f64, compare, concat, concat_str, slice, reserve, push
use test::{assert, assert_eq}
use std::text::Text

@test
func test_text_fill_char() -> I32 {
    let t = Text::new()
    t.fill_char(42, 5)
    assert_eq(t.len(), 5, "fill_char should set length to 5")
    assert_eq(t.as_str(), "*****", "fill_char(42, 5) should be *****")
    t.drop()
    0
}

@test
func test_text_push_formatted() -> I32 {
    let t = Text::new()
    t.push_formatted("[", 42, "]")
    assert_eq(t.as_str(), "[42]", "push_formatted should produce [42]")
    t.drop()
    0
}

@test
func test_text_from_f64() -> I32 {
    let t = Text::from_f64(3.14)
    assert(t.len() > 0, "from_f64 should produce non-empty text")
    t.drop()
    0
}

@test
func test_text_from_f64_precision() -> I32 {
    let t = Text::from_f64_precision(3.14159, 2)
    let s = t.as_str()
    assert(s.len() > 0, "from_f64_precision should produce non-empty text")
    t.drop()
    0
}

@test
func test_text_compare() -> I32 {
    let a = Text::from("abc")
    let b = Text::from("def")
    let c = Text::from("abc")
    assert(a.compare(ref b) < 0, "abc < def")
    assert_eq(a.compare(ref c), 0, "abc == abc")
    assert(b.compare(ref a) > 0, "def > abc")
    a.drop()
    b.drop()
    c.drop()
    0
}

@test
func test_text_concat() -> I32 {
    let a = Text::from("hello")
    let b = Text::from(" world")
    let c = a.concat(ref b)
    assert_eq(c.as_str(), "hello world", "concat should join texts")
    c.drop()
    a.drop()
    b.drop()
    0
}

@test
func test_text_concat_str() -> I32 {
    let a = Text::from("hello")
    let c = a.concat_str(" world")
    assert_eq(c.as_str(), "hello world", "concat_str should join text+str")
    c.drop()
    a.drop()
    0
}

@test
func test_text_slice() -> I32 {
    let t = Text::from("hello world")
    let s = t.slice(6, 11)
    assert_eq(s.as_str(), "world", "slice(6,11) should be world")
    s.drop()
    t.drop()
    0
}

@test
func test_text_reserve() -> I32 {
    let t = Text::new()
    t.reserve(100)
    assert(t.capacity() >= 100, "reserve should grow capacity")
    assert(t.is_empty(), "reserve should not change content")
    t.drop()
    0
}

@test
func test_text_push_byte() -> I32 {
    let t = Text::new()
    t.push(65)
    t.push(66)
    t.push(67)
    assert_eq(t.as_str(), "ABC", "push bytes 65,66,67 should give ABC")
    t.drop()
    0
}
