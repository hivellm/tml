// Tests for std::json nested structures and string/float constructors
use test
use std::json::types::{Json, parse_or_panic}

@test
func test_json_nested_object() -> I32 {
    let j: Json = parse_or_panic("{\"user\": {\"name\": \"Bob\", \"age\": 25}}")
    assert(j.is_object(), "should be object")
    assert(j.has("user"), "should have user field")
    assert_eq(j.len(), 1 as I64, "should have 1 top-level field")
    return 0
}

@test
func test_json_string_constructor() -> I32 {
    let j: Json = Json::string("hello")
    assert(j.is_string(), "should be string")
    let val: Str = j.unwrap_str()
    assert_eq(val, "hello", "value should be hello")
    return 0
}

@test
func test_json_float_constructor() -> I32 {
    let j: Json = Json::float(3.14)
    assert(j.is_number(), "should be number")
    let val: F64 = j.unwrap_f64()
    // Check approximate equality (floating point)
    assert(val > 3.13, "should be > 3.13")
    assert(val < 3.15, "should be < 3.15")
    return 0
}
