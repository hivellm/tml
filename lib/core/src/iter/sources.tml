//! Iterator source types.
//!
//! This module provides types that create iterators from scratch.

// ============================================================================
// Empty Iterator for I32
// ============================================================================

/// An iterator that yields nothing (I32 version).
pub type EmptyI32 {
    _done: Bool
}

impl EmptyI32 {
    pub func next(mut this) -> Maybe[I32] {
        return Nothing
    }
}

/// Creates an iterator that yields nothing (I32 version).
pub func empty_i32() -> EmptyI32 {
    return EmptyI32 { _done: true }
}

// ============================================================================
// Empty Iterator for I64
// ============================================================================

/// An iterator that yields nothing (I64 version).
pub type EmptyI64 {
    _done: Bool
}

impl EmptyI64 {
    pub func next(mut this) -> Maybe[I64] {
        return Nothing
    }
}

/// Creates an iterator that yields nothing (I64 version).
pub func empty_i64() -> EmptyI64 {
    return EmptyI64 { _done: true }
}

// ============================================================================
// Once Iterator for I32
// ============================================================================

/// An iterator that yields exactly one I32 element.
pub type OnceI32 {
    value: Maybe[I32]
}

impl OnceI32 {
    pub func next(mut this) -> Maybe[I32] {
        let result: Maybe[I32] = this.value
        this.value = Nothing
        return result
    }
}

/// Creates an iterator that yields exactly one I32 element.
pub func once_i32(value: I32) -> OnceI32 {
    return OnceI32 { value: Just(value) }
}

// ============================================================================
// Once Iterator for I64
// ============================================================================

/// An iterator that yields exactly one I64 element.
pub type OnceI64 {
    value: Maybe[I64]
}

impl OnceI64 {
    pub func next(mut this) -> Maybe[I64] {
        let result: Maybe[I64] = this.value
        this.value = Nothing
        return result
    }
}

/// Creates an iterator that yields exactly one I64 element.
pub func once_i64(value: I64) -> OnceI64 {
    return OnceI64 { value: Just(value) }
}

// ============================================================================
// RepeatN Iterator for I32
// ============================================================================

/// An iterator that repeats an I32 element a fixed number of times.
pub type RepeatNI32 {
    value: I32,
    remaining: I64
}

impl RepeatNI32 {
    pub func next(mut this) -> Maybe[I32] {
        if this.remaining <= 0 {
            return Nothing
        }
        this.remaining = this.remaining - 1
        return Just(this.value)
    }
}

/// Creates an iterator that repeats an I32 element exactly `n` times.
pub func repeat_n_i32(value: I32, n: I64) -> RepeatNI32 {
    return RepeatNI32 { value: value, remaining: n }
}

// ============================================================================
// RepeatN Iterator for I64
// ============================================================================

/// An iterator that repeats an I64 element a fixed number of times.
pub type RepeatNI64 {
    value: I64,
    remaining: I64
}

impl RepeatNI64 {
    pub func next(mut this) -> Maybe[I64] {
        if this.remaining <= 0 {
            return Nothing
        }
        this.remaining = this.remaining - 1
        return Just(this.value)
    }
}

/// Creates an iterator that repeats an I64 element exactly `n` times.
pub func repeat_n_i64(value: I64, n: I64) -> RepeatNI64 {
    return RepeatNI64 { value: value, remaining: n }
}
