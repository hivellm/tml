// Tests for Array get/first/last with I64 type and edge cases
use test

@test
func test_array_get_i64() -> I32 {
    let arr: [I64; 4] = [100, 200, 300, 400]

    when arr.get(0) {
        Just(v) => assert(*v == 100, "get(0) should be 100"),
        Nothing => assert(false, "get(0) should return Just")
    }

    when arr.get(3) {
        Just(v) => assert(*v == 400, "get(3) should be 400"),
        Nothing => assert(false, "get(3) should return Just")
    }

    when arr.get(4) {
        Just(_) => assert(false, "get(4) should return Nothing"),
        Nothing => {}
    }

    return 0
}

@test
func test_array_first_last_i64() -> I32 {
    let arr: [I64; 3] = [11, 22, 33]

    when arr.first() {
        Just(v) => assert(*v == 11, "first should be 11"),
        Nothing => assert(false, "first should return Just")
    }

    when arr.last() {
        Just(v) => assert(*v == 33, "last should be 33"),
        Nothing => assert(false, "last should return Just")
    }

    return 0
}

@test
func test_array_map_type_conversion() -> I32 {
    let arr: [I32; 3] = [1, 2, 3]
    let mapped: [I64; 3] = arr.map(do(x: I32) -> I64 { return x as I64 * 100 })
    assert(mapped[0] == 100, "map type conversion[0]")
    assert(mapped[1] == 200, "map type conversion[1]")
    assert(mapped[2] == 300, "map type conversion[2]")
    return 0
}
