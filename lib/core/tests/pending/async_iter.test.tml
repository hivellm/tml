// Tests for AsyncIterator types
// Note: Full async iterator testing requires async/await support and Poll types
// which are still being implemented. These tests verify basic type construction.

use test
use core::async_iter::{Once, Repeat}

// ============ Once Type Construction ============

@test
func test_once_type_exists() -> I32 {
    // Verify Once[I32] type can be constructed
    let single: Once[I32] = Once { value: Just(42) }

    // Verify value field is accessible
    when single.value {
        Just(v) => assert_eq(v, 42, "once should contain 42"),
        Nothing => assert(false, "value should be Just")
    }
    return 0
}

@test
func test_once_with_nothing() -> I32 {
    // Once can also be empty
    let empty_once: Once[I32] = Once { value: Nothing }

    when empty_once.value {
        Just(_) => assert(false, "should be Nothing"),
        Nothing => {}
    }
    return 0
}

// ============ Repeat Type Construction ============

@test
func test_repeat_type_exists() -> I32 {
    // Verify Repeat[I32] type can be constructed
    let rep: Repeat[I32] = Repeat { value: 7 }
    assert_eq(rep.value, 7, "repeat should contain 7")
    return 0
}

@test
func test_repeat_negative_value() -> I32 {
    let rep: Repeat[I32] = Repeat { value: -100 }
    assert_eq(rep.value, -100, "repeat should contain -100")
    return 0
}

// ============ Note on Pending Tests ============
// The following tests are pending until async/await and Poll are fully working:
// - poll_next tests
// - async iteration tests
// - FromIter conversion tests
// - Take adapter tests
// - IntoAsyncIterator tests
// - Empty type tests (requires PhantomData)

