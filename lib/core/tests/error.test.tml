// Consolidated tests for core::error (23 tests)

use test
use core::error::{IoErrorKind, IoError, SimpleError, ParseError, BoxedError}

// =============================================================================
// IoErrorKind Tests - These work because IoErrorKind has explicit Display impl
// =============================================================================

@test
func test_io_error_kind_not_found() -> I32 {
    let kind: IoErrorKind = IoErrorKind::NotFound
    let s: Str = kind.to_string()
    assert_eq(s, "entity not found", "NotFound string repr")
    return 0
}

@test
func test_io_error_kind_permission_denied() -> I32 {
    let kind: IoErrorKind = IoErrorKind::PermissionDenied
    let s: Str = kind.to_string()
    assert_eq(s, "permission denied", "PermissionDenied string repr")
    return 0
}

@test
func test_io_error_kind_connection_refused() -> I32 {
    let kind: IoErrorKind = IoErrorKind::ConnectionRefused
    let s: Str = kind.to_string()
    assert_eq(s, "connection refused", "ConnectionRefused string repr")
    return 0
}

@test
func test_io_error_kind_timed_out() -> I32 {
    let kind: IoErrorKind = IoErrorKind::TimedOut
    let s: Str = kind.to_string()
    assert_eq(s, "operation timed out", "TimedOut string repr")
    return 0
}

@test
func test_io_error_kind_other() -> I32 {
    let kind: IoErrorKind = IoErrorKind::Other
    let s: Str = kind.to_string()
    assert_eq(s, "other error", "Other string repr")
    return 0
}

@test
func test_io_error_kind_debug() -> I32 {
    let kind: IoErrorKind = IoErrorKind::NotFound
    let debug: Str = kind.debug_string()
    assert_eq(debug, "NotFound", "Debug should return variant name")
    return 0
}

@test
func test_io_error_kind_broken_pipe() -> I32 {
    let kind: IoErrorKind = IoErrorKind::BrokenPipe
    let s: Str = kind.to_string()
    assert_eq(s, "broken pipe", "BrokenPipe string repr")
    return 0
}

@test
func test_io_error_kind_already_exists() -> I32 {
    let kind: IoErrorKind = IoErrorKind::AlreadyExists
    let s: Str = kind.to_string()
    assert_eq(s, "entity already exists", "AlreadyExists string repr")
    return 0
}

// =============================================================================
// SimpleError Tests (from error.test.tml)
// =============================================================================

@test
func test_simple_error_display() -> I32 {
    let err: SimpleError = SimpleError::new("test message")
    let s: Str = err.to_string()
    assert_eq(s, "test message", "SimpleError to_string")
    return 0
}

@test
func test_simple_error_debug() -> I32 {
    let err: SimpleError = SimpleError::new("oops")
    let s: Str = err.debug_string()
    assert_eq(s, "SimpleError(\"oops\")", "SimpleError debug_string")
    return 0
}

// =============================================================================
// SimpleError Basics Tests (from error_basics.test.tml)
// =============================================================================

@test
func test_simple_error_new() -> I32 {
    let err: SimpleError = SimpleError::new("test error")
    assert(err.message == "test error", "SimpleError should store message")
    return 0
}

@test
func test_simple_error_to_string() -> I32 {
    let err: SimpleError = SimpleError::new("something went wrong")
    let msg: Str = err.to_string()
    assert(msg == "something went wrong", "to_string should return message")
    return 0
}

@test
func test_simple_error_debug_string() -> I32 {
    let err: SimpleError = SimpleError::new("oops")
    let debug: Str = err.debug_string()
    assert(debug == "SimpleError(\"oops\")", "debug_string should format correctly")
    return 0
}

@test
func test_simple_error_empty_message() -> I32 {
    let err: SimpleError = SimpleError::new("")
    assert(err.to_string() == "", "Empty message should work")
    return 0
}

@test
func test_simple_error_with_numbers() -> I32 {
    let err: SimpleError = SimpleError::new("error code: 42")
    assert(err.to_string() == "error code: 42", "Message with numbers should work")
    return 0
}

// =============================================================================
// ParseError Tests
// =============================================================================

@test
func test_parse_error_display() -> I32 {
    let err: ParseError = ParseError::new("unexpected token")
    let s: Str = err.to_string()
    assert_eq(s, "parse error: unexpected token", "ParseError to_string")
    return 0
}

@test
func test_parse_error_with_position() -> I32 {
    let err: ParseError = ParseError::with_position("expected '}'", 42)
    let s: Str = err.to_string()
    assert_eq(s, "parse error at position 42: expected '}'", "ParseError with position")
    return 0
}

@test
func test_parse_error_debug() -> I32 {
    let err: ParseError = ParseError::new("syntax error")
    let s: Str = err.debug_string()
    assert_eq(s, "ParseError { message: \"syntax error\", position: Nothing }", "ParseError debug")
    return 0
}

// =============================================================================
// IoError Tests
// =============================================================================

@test
func test_io_error_display() -> I32 {
    let err: IoError = IoError::new(IoErrorKind::PermissionDenied)
    let s: Str = err.to_string()
    assert_eq(s, "permission denied", "IoError to_string")
    return 0
}

@test
func test_io_error_with_message() -> I32 {
    let err: IoError = IoError::with_message(IoErrorKind::NotFound, "config.json")
    let s: Str = err.to_string()
    assert_eq(s, "entity not found: config.json", "IoError with message")
    return 0
}

@test
func test_io_error_kind_method() -> I32 {
    let err: IoError = IoError::new(IoErrorKind::TimedOut)
    let kind: IoErrorKind = err.kind()
    let s: Str = kind.to_string()
    assert_eq(s, "operation timed out", "IoError kind method")
    return 0
}

// =============================================================================
// IoErrorKind Extended Variant Tests
// =============================================================================

@test
func test_io_error_kind_connection_reset() -> I32 {
    let k: IoErrorKind = IoErrorKind::ConnectionReset
    assert_eq(k.to_string(), "connection reset", "ConnectionReset display")
    assert_eq(k.debug_string(), "ConnectionReset", "ConnectionReset debug")
    return 0
}

@test
func test_io_error_kind_not_connected() -> I32 {
    let k: IoErrorKind = IoErrorKind::NotConnected
    assert_eq(k.to_string(), "not connected", "NotConnected display")
    assert_eq(k.debug_string(), "NotConnected", "NotConnected debug")
    return 0
}

@test
func test_io_error_kind_addr_in_use() -> I32 {
    let k: IoErrorKind = IoErrorKind::AddrInUse
    assert_eq(k.to_string(), "address in use", "AddrInUse display")
    return 0
}

@test
func test_io_error_kind_would_block() -> I32 {
    let k: IoErrorKind = IoErrorKind::WouldBlock
    assert_eq(k.to_string(), "operation would block", "WouldBlock display")
    return 0
}

@test
func test_io_error_kind_invalid_input() -> I32 {
    let k: IoErrorKind = IoErrorKind::InvalidInput
    assert_eq(k.to_string(), "invalid input parameter", "InvalidInput display")
    return 0
}

@test
func test_io_error_kind_unexpected_eof() -> I32 {
    let k: IoErrorKind = IoErrorKind::UnexpectedEof
    assert_eq(k.to_string(), "unexpected end of file", "UnexpectedEof display")
    return 0
}

@test
func test_io_error_kind_connection_aborted() -> I32 {
    let k: IoErrorKind = IoErrorKind::ConnectionAborted
    assert_eq(k.to_string(), "connection aborted", "ConnectionAborted display")
    assert_eq(k.debug_string(), "ConnectionAborted", "ConnectionAborted debug")
    return 0
}

@test
func test_io_error_kind_addr_not_available() -> I32 {
    let k: IoErrorKind = IoErrorKind::AddrNotAvailable
    assert_eq(k.to_string(), "address not available", "AddrNotAvailable display")
    assert_eq(k.debug_string(), "AddrNotAvailable", "AddrNotAvailable debug")
    return 0
}

@test
func test_io_error_kind_invalid_data() -> I32 {
    let k: IoErrorKind = IoErrorKind::InvalidData
    assert_eq(k.to_string(), "invalid data", "InvalidData display")
    assert_eq(k.debug_string(), "InvalidData", "InvalidData debug")
    return 0
}

@test
func test_io_error_kind_write_zero() -> I32 {
    let k: IoErrorKind = IoErrorKind::WriteZero
    assert_eq(k.to_string(), "write zero", "WriteZero display")
    assert_eq(k.debug_string(), "WriteZero", "WriteZero debug")
    return 0
}

@test
func test_io_error_kind_interrupted() -> I32 {
    let k: IoErrorKind = IoErrorKind::Interrupted
    assert_eq(k.to_string(), "operation interrupted", "Interrupted display")
    assert_eq(k.debug_string(), "Interrupted", "Interrupted debug")
    return 0
}

@test
func test_io_error_kind_out_of_memory() -> I32 {
    let k: IoErrorKind = IoErrorKind::OutOfMemory
    assert_eq(k.to_string(), "out of memory", "OutOfMemory display")
    assert_eq(k.debug_string(), "OutOfMemory", "OutOfMemory debug")
    return 0
}

// =============================================================================
// IoError Debug Tests
// =============================================================================

@test
func test_io_error_debug_no_message() -> I32 {
    let err: IoError = IoError::new(IoErrorKind::NotFound)
    let s: Str = err.debug_string()
    assert_eq(s, "IoError { kind: entity not found, message: Nothing }", "IoError debug no message")
    return 0
}

@test
func test_io_error_debug_with_message() -> I32 {
    let err: IoError = IoError::with_message(IoErrorKind::PermissionDenied, "/etc/shadow")
    let s: Str = err.debug_string()
    assert_eq(s, "IoError { kind: permission denied, message: Just(\"/etc/shadow\") }", "IoError debug with message")
    return 0
}

// =============================================================================
// BoxedError Tests
// =============================================================================

@test
func test_boxed_error_from_message() -> I32 {
    let err: BoxedError = BoxedError::from_message("something failed")
    assert_eq(err.to_string(), "something failed", "BoxedError from_message display")
    return 0
}

@test
func test_boxed_error_debug() -> I32 {
    let err: BoxedError = BoxedError::from_message("oops")
    let s: Str = err.debug_string()
    assert_eq(s, "BoxedError { message: oops }", "BoxedError debug")
    return 0
}

// =============================================================================
// ParseError Extended Tests
// =============================================================================

@test
func test_parse_error_debug_with_position() -> I32 {
    let err: ParseError = ParseError::with_position("bad token", 10)
    let s: Str = err.debug_string()
    assert_eq(s, "ParseError { message: \"bad token\", position: Just(10) }", "ParseError debug with position")
    return 0
}
