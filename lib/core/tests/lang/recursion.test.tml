// Tests for recursive functions
use test

// =============================================================================
// Basic recursion
// =============================================================================

func factorial(n: I32) -> I32 {
    if n <= 1 {
        return 1
    }
    return n * factorial(n - 1)
}

@test
func test_factorial_0() -> I32 {
    assert_eq(factorial(0), 1, "0! should be 1")
    return 0
}

@test
func test_factorial_5() -> I32 {
    assert_eq(factorial(5), 120, "5! should be 120")
    return 0
}

@test
func test_factorial_10() -> I32 {
    assert_eq(factorial(10), 3628800, "10! should be 3628800")
    return 0
}

// =============================================================================
// Fibonacci
// =============================================================================

func fibonacci(n: I32) -> I32 {
    if n <= 0 {
        return 0
    }
    if n == 1 {
        return 1
    }
    return fibonacci(n - 1) + fibonacci(n - 2)
}

@test
func test_fib_0() -> I32 {
    assert_eq(fibonacci(0), 0, "fib(0) should be 0")
    return 0
}

@test
func test_fib_1() -> I32 {
    assert_eq(fibonacci(1), 1, "fib(1) should be 1")
    return 0
}

@test
func test_fib_10() -> I32 {
    assert_eq(fibonacci(10), 55, "fib(10) should be 55")
    return 0
}

// =============================================================================
// Recursive sum
// =============================================================================

func sum_to(n: I32) -> I32 {
    if n <= 0 {
        return 0
    }
    return n + sum_to(n - 1)
}

@test
func test_sum_to_100() -> I32 {
    assert_eq(sum_to(100), 5050, "sum 1..100 should be 5050")
    return 0
}

// =============================================================================
// Recursive GCD (Euclidean algorithm)
// =============================================================================

func gcd(a: I32, b: I32) -> I32 {
    if b == 0 {
        return a
    }
    return gcd(b, a % b)
}

@test
func test_gcd_12_8() -> I32 {
    assert_eq(gcd(12, 8), 4, "gcd(12, 8) should be 4")
    return 0
}

@test
func test_gcd_48_18() -> I32 {
    assert_eq(gcd(48, 18), 6, "gcd(48, 18) should be 6")
    return 0
}

@test
func test_gcd_same() -> I32 {
    assert_eq(gcd(7, 7), 7, "gcd(7, 7) should be 7")
    return 0
}

// =============================================================================
// Recursive power
// =============================================================================

func power(b: I32, n: I32) -> I32 {
    if n == 0 {
        return 1
    }
    return b * power(b, n - 1)
}

@test
func test_power_2_10() -> I32 {
    assert_eq(power(2, 10), 1024, "2^10 should be 1024")
    return 0
}

@test
func test_power_3_4() -> I32 {
    assert_eq(power(3, 4), 81, "3^4 should be 81")
    return 0
}
