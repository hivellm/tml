// Tests for behavior (trait) definitions and impl blocks
use test

// =============================================================================
// Basic impl with methods
// =============================================================================

type Counter {
    value: I32
}

impl Counter {
    func new(start: I32) -> Counter {
        return Counter { value: start }
    }

    func get(this) -> I32 {
        return this.value
    }

    func increment(this) -> Counter {
        return Counter { value: this.value + 1 }
    }

    func add(this, n: I32) -> Counter {
        return Counter { value: this.value + n }
    }
}

@test
func test_impl_new() -> I32 {
    let c: Counter = Counter::new(0)
    assert_eq(c.get(), 0, "Counter::new(0) should start at 0")
    return 0
}

@test
func test_impl_method_call() -> I32 {
    let c: Counter = Counter::new(5)
    let c2: Counter = c.increment()
    assert_eq(c2.get(), 6, "increment should add 1")
    return 0
}

@test
func test_impl_method_with_args() -> I32 {
    let c: Counter = Counter::new(10)
    let c2: Counter = c.add(5)
    assert_eq(c2.get(), 15, "add(5) should add 5")
    return 0
}
