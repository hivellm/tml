// Tests for RandomState::new(), Duplicate, and Default impls
use test
use core::hash::{RandomState, DefaultHasher}
use core::clone::Duplicate

@test
func test_random_state_new() -> I32 {
    let rs: RandomState = RandomState::new()
    let hasher: DefaultHasher = rs.build_hasher()
    let h: I64 = hasher.finish()
    // Should produce a valid hash value
    assert(h == h, "RandomState::new() should produce valid hasher")
    return 0
}

@test
func test_random_state_duplicate() -> I32 {
    let rs: RandomState = RandomState::with_keys(10 as U64, 20 as U64)
    let copy: RandomState = rs.duplicate()
    let h1: DefaultHasher = rs.build_hasher()
    let h2: DefaultHasher = copy.build_hasher()
    assert_eq(h1.finish(), h2.finish(), "duplicated RandomState should produce same hasher")
    return 0
}

@test
func test_random_state_duplicate_hasher_same_output() -> I32 {
    let rs: RandomState = RandomState::with_keys(42 as U64, 99 as U64)
    let copy: RandomState = rs.duplicate()
    var h1: DefaultHasher = rs.build_hasher()
    var h2: DefaultHasher = copy.build_hasher()
    h1.write_i64(555)
    h2.write_i64(555)
    assert_eq(h1.finish(), h2.finish(), "hashers from duplicated state should match")
    return 0
}
