// Tests for RandomState (new, with_keys, build_hasher, Default, Duplicate)
use test
use core::hash::{RandomState, DefaultHasher}
use core::clone::Duplicate

@test
func test_random_state_with_keys() -> I32 {
    let rs: RandomState = RandomState::with_keys(100 as U64, 200 as U64)
    let hasher: DefaultHasher = rs.build_hasher()
    let h: I64 = hasher.finish()
    // Hasher from with_keys should have deterministic initial state
    let rs2: RandomState = RandomState::with_keys(100 as U64, 200 as U64)
    let hasher2: DefaultHasher = rs2.build_hasher()
    assert_eq(h, hasher2.finish(), "same keys should produce same hasher")
    return 0
}

@test
func test_random_state_different_keys() -> I32 {
    let rs1: RandomState = RandomState::with_keys(1 as U64, 2 as U64)
    let rs2: RandomState = RandomState::with_keys(3 as U64, 4 as U64)
    let h1: DefaultHasher = rs1.build_hasher()
    let h2: DefaultHasher = rs2.build_hasher()
    assert(h1.finish() != h2.finish(), "different keys should produce different hashers")
    return 0
}

@test
func test_random_state_build_hasher_usable() -> I32 {
    let rs: RandomState = RandomState::with_keys(42 as U64, 99 as U64)
    var hasher: DefaultHasher = rs.build_hasher()
    hasher.write_i64(12345)
    let h: I64 = hasher.finish()
    // Hash should be deterministic for same state + same input
    var hasher2: DefaultHasher = rs.build_hasher()
    hasher2.write_i64(12345)
    assert_eq(h, hasher2.finish(), "same hasher + same input = same hash")
    return 0
}
