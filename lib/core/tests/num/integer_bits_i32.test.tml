// Tests for core::num::integer â€” I32 bit manipulation functions
use test::{assert, assert_eq}
use core::num::integer::{
    count_ones_i32, count_zeros_i32, leading_zeros_i32, trailing_zeros_i32,
    rotate_left_i32, rotate_right_i32, swap_bytes_i32, reverse_bits_i32
}

@test
func test_count_ones_i32_basic() -> I32 {
    assert_eq(count_ones_i32(0), 0, "count_ones(0) = 0")
    assert_eq(count_ones_i32(1), 1, "count_ones(1) = 1")
    assert_eq(count_ones_i32(7), 3, "count_ones(7) = 3")
    assert_eq(count_ones_i32(255), 8, "count_ones(255) = 8")
    return 0
}

@test
func test_count_zeros_i32() -> I32 {
    assert_eq(count_zeros_i32(0), 32, "count_zeros(0) = 32")
    assert_eq(count_zeros_i32(255), 24, "count_zeros(255) = 24")
    return 0
}

@test
func test_leading_zeros_i32() -> I32 {
    assert_eq(leading_zeros_i32(0), 32, "lz(0) = 32")
    assert_eq(leading_zeros_i32(1), 31, "lz(1) = 31")
    assert_eq(leading_zeros_i32(16), 27, "lz(16) = 27")
    return 0
}

@test
func test_trailing_zeros_i32() -> I32 {
    assert_eq(trailing_zeros_i32(0), 32, "tz(0) = 32")
    assert_eq(trailing_zeros_i32(1), 0, "tz(1) = 0")
    assert_eq(trailing_zeros_i32(16), 4, "tz(16) = 4")
    assert_eq(trailing_zeros_i32(8), 3, "tz(8) = 3")
    return 0
}

@test
func test_rotate_left_i32() -> I32 {
    let val: I32 = 1
    let rotated: I32 = rotate_left_i32(val, 4)
    assert_eq(rotated, 16, "rotate_left(1, 4) = 16")
    // rotation by 0 should be identity
    assert_eq(rotate_left_i32(42, 0), 42, "rotate_left(42, 0) = 42")
    return 0
}

@test
func test_rotate_right_i32() -> I32 {
    let val: I32 = 16
    let rotated: I32 = rotate_right_i32(val, 4)
    assert_eq(rotated, 1, "rotate_right(16, 4) = 1")
    assert_eq(rotate_right_i32(42, 0), 42, "rotate_right(42, 0) = 42")
    return 0
}

@test
func test_swap_bytes_i32() -> I32 {
    // 0x01020304 -> 0x04030201
    let val: I32 = 16909060  // 0x01020304
    let swapped: I32 = swap_bytes_i32(val)
    assert_eq(swapped, 67305985, "swap_bytes_i32(0x01020304) = 0x04030201")
    return 0
}

@test
func test_reverse_bits_i32() -> I32 {
    // reverse_bits(1) should have the MSB set
    let r: I32 = reverse_bits_i32(1)
    assert(r < 0, "reverse_bits(1) should be negative (MSB set)")
    // reverse_bits(0) = 0
    assert_eq(reverse_bits_i32(0), 0, "reverse_bits(0) = 0")
    return 0
}
