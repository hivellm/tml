use test
use core::ringbuf::RingBuf

@test
func test_ringbuf_new() -> I32 {
    var rb: RingBuf = RingBuf::new(4)
    assert_eq(rb.len(), 0)
    assert_eq(rb.capacity(), 4)
    assert(rb.is_empty())
    assert(rb.is_full() == false)
    return 0
}

@test
func test_ringbuf_push_pop() -> I32 {
    var rb: RingBuf = RingBuf::new(4)
    assert(rb.push_back(10))
    assert(rb.push_back(20))
    assert(rb.push_back(30))
    assert_eq(rb.len(), 3)

    let v1: Maybe[I64] = rb.pop_front()
    assert_eq(v1.unwrap(), 10)
    let v2: Maybe[I64] = rb.pop_front()
    assert_eq(v2.unwrap(), 20)
    assert_eq(rb.len(), 1)
    return 0
}

@test
func test_ringbuf_full() -> I32 {
    var rb: RingBuf = RingBuf::new(2)
    assert(rb.push_back(1))
    assert(rb.push_back(2))
    assert(rb.is_full())
    assert(rb.push_back(3) == false)
    assert_eq(rb.len(), 2)
    return 0
}
