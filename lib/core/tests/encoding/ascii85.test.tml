use test
use core::encoding::ascii85

@test
func test_ascii85_encode_empty() -> I32 {
    assert_eq(ascii85::encode(""), "<~~>")
    0
}

@test
func test_ascii85_encode_man() -> I32 {
    // "Man " (4 bytes, full group)
    assert_eq(ascii85::encode("Man "), "<~9jqo^~>")
    0
}

@test
func test_ascii85_encode_test() -> I32 {
    assert_eq(ascii85::encode("test"), "<~FCfN8~>")
    0
}

@test
func test_ascii85_decode_empty() -> I32 {
    let result = ascii85::decode("<~~>")
    when result {
        Ok(s) => assert_eq(s, "")
        Err(e) => assert(false, "decode empty should succeed")
    }
    0
}

@test
func test_ascii85_roundtrip_short() -> I32 {
    let original = "Hi!"
    let encoded = ascii85::encode(original)
    let result = ascii85::decode(encoded)
    when result {
        Ok(decoded) => assert_eq(decoded, original)
        Err(e) => assert(false, "roundtrip should succeed")
    }
    0
}

@test
func test_ascii85_roundtrip_full_group() -> I32 {
    let original = "test"
    let encoded = ascii85::encode(original)
    let result = ascii85::decode(encoded)
    when result {
        Ok(decoded) => assert_eq(decoded, original)
        Err(e) => assert(false, "roundtrip should succeed")
    }
    0
}

@test
func test_ascii85_roundtrip_hello() -> I32 {
    let original = "Hello"
    let encoded = ascii85::encode(original)
    let result = ascii85::decode(encoded)
    when result {
        Ok(decoded) => assert_eq(decoded, original)
        Err(e) => assert(false, "roundtrip should succeed")
    }
    0
}

@test
func test_ascii85_roundtrip_longer() -> I32 {
    let original = "Hello, World!"
    let encoded = ascii85::encode(original)
    let result = ascii85::decode(encoded)
    when result {
        Ok(decoded) => assert_eq(decoded, original)
        Err(e) => assert(false, "roundtrip should succeed")
    }
    0
}

@test
func test_ascii85_decode_missing_prefix() -> I32 {
    let result = ascii85::decode("hello~>")
    when result {
        Ok(s) => assert(false, "missing prefix should fail")
        Err(e) => assert(true, "expected error")
    }
    0
}

@test
func test_ascii85_decode_too_short() -> I32 {
    let result = ascii85::decode("<~")
    when result {
        Ok(s) => assert(false, "too short should fail")
        Err(e) => assert(true, "expected error")
    }
    0
}
