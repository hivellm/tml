// Tests for Array methods: map with different types, large arrays
use test::{assert, assert_eq}

@test
func test_array_map_i64() -> I32 {
    let arr: [I64; 3] = [100 as I64, 200 as I64, 300 as I64]
    let doubled: [I64; 3] = arr.map(do(x: I64) -> I64 { return x * 2 as I64 })
    assert(doubled[0] == 200 as I64, "doubled[0] should be 200")
    assert(doubled[1] == 400 as I64, "doubled[1] should be 400")
    assert(doubled[2] == 600 as I64, "doubled[2] should be 600")
    return 0
}

@test
func test_array_map_i32_to_i32_abs() -> I32 {
    let arr: [I32; 4] = [-5, 3, -1, 7]
    let abs_arr: [I32; 4] = arr.map(do(x: I32) -> I32 {
        if x < 0 { return 0 - x }
        return x
    })
    assert_eq(abs_arr[0], 5, "abs(-5) = 5")
    assert_eq(abs_arr[1], 3, "abs(3) = 3")
    assert_eq(abs_arr[2], 1, "abs(-1) = 1")
    assert_eq(abs_arr[3], 7, "abs(7) = 7")
    return 0
}

@test
func test_array_large_8_elements() -> I32 {
    let arr: [I32; 8] = [1, 2, 3, 4, 5, 6, 7, 8]
    assert_eq(arr.len(), 8, "8-element array len")
    assert(arr[0] == 1, "first element")
    assert(arr[7] == 8, "last element")
    let mut sum: I32 = 0
    let mut i: I64 = 0
    loop (i < 8) {
        sum = sum + arr[i]
        i = i + 1
    }
    assert_eq(sum, 36, "sum of 1..8 = 36")
    return 0
}
