// Tests for RawPtr alignment and ordering
use test
use core::ptr::const_ptr::RawPtr
use core::ptr::ops::align_of

@test
func test_rawptr_is_aligned_i64() -> I32 {
    let aligned: RawPtr[I64] = RawPtr[I64].from_addr(0x1000)
    let unaligned: RawPtr[I64] = RawPtr[I64].from_addr(0x1001)
    assert(aligned.is_aligned(), "0x1000 should be aligned for I64")
    assert(not unaligned.is_aligned(), "0x1001 should not be aligned for I64")
    return 0
}

@test
func test_rawptr_cmp() -> I32 {
    let a: RawPtr[I32] = RawPtr[I32].from_addr(100)
    let b: RawPtr[I32] = RawPtr[I32].from_addr(200)
    let c: RawPtr[I32] = RawPtr[I32].from_addr(100)
    let ab: Ordering = a.cmp(ref b)
    let ba: Ordering = b.cmp(ref a)
    let ac: Ordering = a.cmp(ref c)
    when ab {
        Less => {},
        _ => assert(false, "a < b should be Less")
    }
    when ba {
        Greater => {},
        _ => assert(false, "b > a should be Greater")
    }
    when ac {
        Equal => {},
        _ => assert(false, "a == c should be Equal")
    }
    return 0
}

@test
func test_align_of_types() -> I32 {
    let a1: I64 = align_of[U8]()
    let a4: I64 = align_of[I32]()
    let a8: I64 = align_of[I64]()
    assert_eq(a1, 1 as I64, "U8 align should be 1")
    assert_eq(a4, 4 as I64, "I32 align should be 4")
    assert_eq(a8, 8 as I64, "I64 align should be 8")
    return 0
}
