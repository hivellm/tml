// Tests for core::ptr::ops â€” size_of, align_of, make_null, from_addr, eq
use test::{assert, assert_eq}
use core::ptr::ops::{size_of, align_of, make_null, make_null_mut, from_addr, from_addr_mut, eq, eq_mut}
use core::ptr::const_ptr::RawPtr
use core::ptr::mut_ptr::RawMutPtr

// === size_of ===

@test
func test_size_of_i8() -> I32 {
    assert_eq(size_of[I8](), 1 as I64, "size_of[I8] should be 1")
    return 0
}

@test
func test_size_of_i32() -> I32 {
    assert_eq(size_of[I32](), 4 as I64, "size_of[I32] should be 4")
    return 0
}

@test
func test_size_of_i64() -> I32 {
    assert_eq(size_of[I64](), 8 as I64, "size_of[I64] should be 8")
    return 0
}

@test
func test_size_of_u8() -> I32 {
    assert_eq(size_of[U8](), 1 as I64, "size_of[U8] should be 1")
    return 0
}

@test
func test_size_of_bool() -> I32 {
    assert_eq(size_of[Bool](), 1 as I64, "size_of[Bool] should be 1")
    return 0
}

// === align_of ===

@test
func test_align_of_i8() -> I32 {
    assert_eq(align_of[I8](), 1 as I64, "align_of[I8] should be 1")
    return 0
}

@test
func test_align_of_i32() -> I32 {
    assert_eq(align_of[I32](), 4 as I64, "align_of[I32] should be 4")
    return 0
}

@test
func test_align_of_i64() -> I32 {
    assert_eq(align_of[I64](), 8 as I64, "align_of[I64] should be 8")
    return 0
}

// === make_null / from_addr / eq ===

@test
func test_make_null_is_null() -> I32 {
    let p: RawPtr[I64] = make_null[I64]()
    assert(p.is_null(), "make_null should create null pointer")
    return 0
}

@test
func test_make_null_mut_is_null() -> I32 {
    let p: RawMutPtr[I64] = make_null_mut[I64]()
    assert(p.is_null(), "make_null_mut should create null pointer")
    return 0
}

@test
func test_from_addr_not_null() -> I32 {
    let p: RawPtr[I64] = from_addr[I64](0x1000 as I64)
    assert(not p.is_null(), "from_addr(0x1000) should not be null")
    return 0
}

@test
func test_from_addr_mut_not_null() -> I32 {
    let p: RawMutPtr[I64] = from_addr_mut[I64](0x2000 as I64)
    assert(not p.is_null(), "from_addr_mut(0x2000) should not be null")
    return 0
}

@test
func test_eq_same_addr() -> I32 {
    let a: RawPtr[I64] = from_addr[I64](0x1000 as I64)
    let b: RawPtr[I64] = from_addr[I64](0x1000 as I64)
    assert(eq(a, b), "same address pointers should be equal")
    return 0
}

@test
func test_eq_different_addr() -> I32 {
    let a: RawPtr[I64] = from_addr[I64](0x1000 as I64)
    let b: RawPtr[I64] = from_addr[I64](0x2000 as I64)
    assert(not eq(a, b), "different address pointers should not be equal")
    return 0
}

@test
func test_eq_mut_same_addr() -> I32 {
    let a: RawMutPtr[I64] = from_addr_mut[I64](0x3000 as I64)
    let b: RawMutPtr[I64] = from_addr_mut[I64](0x3000 as I64)
    assert(eq_mut(a, b), "same address mut pointers should be equal")
    return 0
}
