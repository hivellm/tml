// Network utilities

/// TCP listener for accepting connections
pub type TcpListener {
    port: U16,
}

/// TCP stream for network communication
pub type TcpStream {
    connected: Bool,
}

impl TcpListener {
    /// Bind to an address
    pub func bind(addr: Str) -> Outcome[TcpListener, Str] {
        // TODO: Call builtin tcp_bind
        return Err("not implemented")
    }

    /// Accept a connection
    pub func accept(this) -> Outcome[TcpStream, Str] {
        // TODO: Call builtin tcp_accept
        return Err("not implemented")
    }
}

impl TcpStream {
    /// Connect to an address
    pub func connect(addr: Str) -> Outcome[TcpStream, Str] {
        // TODO: Call builtin tcp_connect
        return Err("not implemented")
    }

    /// Read from the stream
    pub func read(this, buf: mut ref Vec[U8]) -> Outcome[I32, Str] {
        // TODO: Call builtin tcp_read
        return Err("not implemented")
    }

    /// Write to the stream
    pub func write(this, data: ref Vec[U8]) -> Outcome[I32, Str] {
        // TODO: Call builtin tcp_write
        return Err("not implemented")
    }
}

@test
func test_tcp_stream_creation() {
    // Just verify types compile
    let stream: Outcome[TcpStream, Str] = TcpStream::connect("127.0.0.1:8080")
    assert!(stream.is_err())
}
