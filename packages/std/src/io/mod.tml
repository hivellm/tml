// I/O operations

use error::{Error, IoError}
use result::Outcome

/// Read trait for types that can be read from
pub behavior Read {
    func read(mut this, buf: mut [U8]) -> Outcome[I32, IoError]
    func read_to_end(mut this, buf: mut Vec[U8]) -> Outcome[I32, IoError]
}

/// Write trait for types that can be written to
pub behavior Write {
    func write(mut this, buf: [U8]) -> Outcome[I32, IoError]
    func flush(mut this) -> Outcome[(), IoError]
    func write_all(mut this, buf: [U8]) -> Outcome[(), IoError]
}

/// Print to stdout (no newline)
pub func print(s: Str) {
    // TODO: Implement when C bindings are ready
}

/// Print to stdout with newline
pub func println(s: Str) {
    // TODO: Implement when C bindings are ready
}

/// Read a line from stdin
pub func read_line() -> Outcome[Str, IoError] {
    // TODO: Implement
    Err(IoError::Other("not yet implemented"))
}

/// Standard input handle
pub type Stdin {
    // Internal implementation
}

impl Read for Stdin {
    func read(mut this, buf: mut [U8]) -> Outcome[I32, IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }

    func read_to_end(mut this, buf: mut Vec[U8]) -> Outcome[I32, IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }
}

/// Standard output handle
pub type Stdout {
    // Internal implementation
}

impl Write for Stdout {
    func write(mut this, buf: [U8]) -> Outcome[I32, IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }

    func flush(mut this) -> Outcome[(), IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }

    func write_all(mut this, buf: [U8]) -> Outcome[(), IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }
}

/// Standard error handle
pub type Stderr {
    // Internal implementation
}

impl Write for Stderr {
    func write(mut this, buf: [U8]) -> Outcome[I32, IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }

    func flush(mut this) -> Outcome[(), IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }

    func write_all(mut this, buf: [U8]) -> Outcome[(), IoError] {
        // TODO: Implement
        Err(IoError::Other("not yet implemented"))
    }
}

/// Get stdin handle
pub func stdin() -> Stdin {
    Stdin {}
}

/// Get stdout handle
pub func stdout() -> Stdout {
    Stdout {}
}

/// Get stderr handle
pub func stderr() -> Stderr {
    Stderr {}
}
