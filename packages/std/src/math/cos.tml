// Cosine function using Taylor series

use const::Pi
use abs
use sin::reduce_angle

// cos(x) using Taylor series
// cos(x) = 1 - x^2/2! + x^4/4! - x^6/6! + ...
pub func cos(x: F64) -> F64 {
    if x == 0.0 then return 1.0

    // Reduce angle to [-Ï€, Ï€]
    let angle: F64 = reduce_angle(x)

    let mut sum: F64 = 1.0
    let mut term: F64 = 1.0
    let mut i: I32 = 1

    loop {
        if i > 15 then break

        // Next term: multiply by -x^2 / ((2i-1)(2i))
        let denominator: I32 = (2 * i - 1) * (2 * i)
        term = term * (-angle) * angle / i32_to_f64(denominator)
        sum = sum + term

        let abs_term: F64 = abs(term)
        if abs_term < 0.00000001 then break

        i = i + 1
    }

    return sum
}

// sincos(x) returns sin(x) and cos(x) simultaneously
pub func sincos(x: F64) -> (F64, F64) {
    return (sin(x), cos(x))
}
