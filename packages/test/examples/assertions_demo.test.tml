use test

// ============ Assertion Comprehensive Demo ============

@test
func test_assert_basic() -> I32 {
    // Basic assert with true
    assert(true, "true is true")
    assert(1 == 1, "1 equals 1")
    assert(5 > 3, "5 > 3")

    return 0
}

@test
func test_assert_eq_i32() -> I32 {
    assert_eq_i32(0, 0, "zero equals zero")
    assert_eq_i32(42, 42, "42 equals 42")
    assert_eq_i32(-10, -10, "negative equals negative")

    let x: I32 = 100
    let y: I32 = 100
    assert_eq_i32(x, y, "variables equal")

    assert_eq_i32(5 + 5, 10, "expression equals literal")
    assert_eq_i32(3 * 4, 12, "multiplication")

    return 0
}

@test
func test_assert_ne_i32() -> I32 {
    assert_ne_i32(1, 2, "1 != 2")
    assert_ne_i32(0, 1, "0 != 1")
    assert_ne_i32(-1, 1, "-1 != 1")
    assert_ne_i32(100, 99, "100 != 99")

    return 0
}

@test
func test_assert_eq_bool() -> I32 {
    assert_eq_bool(true, true, "true == true")
    assert_eq_bool(false, false, "false == false")

    let t: Bool = true
    let f: Bool = false
    assert_eq_bool(t, true, "var true == true")
    assert_eq_bool(f, false, "var false == false")

    // Boolean expressions
    assert_eq_bool(5 > 3, true, "comparison is true")
    assert_eq_bool(3 > 5, false, "comparison is false")

    return 0
}

@test
func test_assert_eq_str() -> I32 {
    assert_eq_str("hello", "hello", "hello == hello")
    assert_eq_str("", "", "empty == empty")
    assert_eq_str("test", "test", "test == test")

    let s: Str = "world"
    assert_eq_str(s, "world", "var equals literal")

    return 0
}

// ============ Assertions with Computed Values ============

func double(x: I32) -> I32 {
    return x * 2
}

func square(x: I32) -> I32 {
    return x * x
}

@test
func test_assertions_with_functions() -> I32 {
    assert_eq_i32(double(5), 10, "double(5) = 10")
    assert_eq_i32(double(0), 0, "double(0) = 0")
    assert_eq_i32(double(-3), -6, "double(-3) = -6")

    assert_eq_i32(square(4), 16, "square(4) = 16")
    assert_eq_i32(square(0), 0, "square(0) = 0")
    assert_eq_i32(square(5), 25, "square(5) = 25")

    // Composed
    assert_eq_i32(double(square(3)), 18, "double(square(3)) = 18")

    return 0
}

// ============ Assertions in Loops ============

@test
func test_assertions_in_loop() -> I32 {
    let mut i: I32 = 0
    loop {
        if i >= 5 then break

        let doubled: I32 = i * 2
        let expected: I32 = i + i
        assert_eq_i32(doubled, expected, "i*2 == i+i")

        i = i + 1
    }

    return 0
}

// ============ Multiple Assertions ============

@test
func test_many_assertions() -> I32 {
    // Test a series of values
    assert_eq_i32(1 + 1, 2, "1+1")
    assert_eq_i32(2 + 2, 4, "2+2")
    assert_eq_i32(3 + 3, 6, "3+3")
    assert_eq_i32(4 + 4, 8, "4+4")
    assert_eq_i32(5 + 5, 10, "5+5")

    assert_eq_i32(10 - 1, 9, "10-1")
    assert_eq_i32(10 - 2, 8, "10-2")
    assert_eq_i32(10 - 3, 7, "10-3")
    assert_eq_i32(10 - 4, 6, "10-4")
    assert_eq_i32(10 - 5, 5, "10-5")

    assert_eq_i32(2 * 1, 2, "2*1")
    assert_eq_i32(2 * 2, 4, "2*2")
    assert_eq_i32(2 * 3, 6, "2*3")
    assert_eq_i32(2 * 4, 8, "2*4")
    assert_eq_i32(2 * 5, 10, "2*5")

    return 0
}

// ============ Edge Cases ============

@test
func test_edge_cases() -> I32 {
    // Max/min I32 operations (be careful not to overflow)
    assert_eq_i32(1000000 + 1000000, 2000000, "large addition")
    assert_eq_i32(1000000 - 1000000, 0, "large subtraction")

    // Zero operations
    assert_eq_i32(0 + 0, 0, "0+0")
    assert_eq_i32(0 - 0, 0, "0-0")
    assert_eq_i32(0 * 100, 0, "0*100")

    // Negative operations
    assert_eq_i32(-5 + -5, -10, "-5+-5")
    assert_eq_i32(-5 - -5, 0, "-5--5")
    assert_eq_i32(-5 * -2, 10, "-5*-2")

    return 0
}
