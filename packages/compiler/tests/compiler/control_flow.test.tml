use test

// Test while loops
@test
func test_while_loop() -> I32 {
    let mut count: I32 = 0
    let mut sum: I32 = 0

    while count < 5 {
        sum = sum + count
        count = count + 1
    }

    assert_eq(sum, 10, "while loop sum should be 10 (0+1+2+3+4)")
    assert_eq(count, 5, "while loop count should be 5")
    return 0
}

@test
func test_while_with_break() -> I32 {
    let mut i: I32 = 0
    let mut result: I32 = 0

    while i < 100 {
        if i == 5 then break
        result = result + i
        i = i + 1
    }

    assert_eq(result, 10, "while with break should sum 0+1+2+3+4")
    assert_eq(i, 5, "while with break should stop at i=5")
    return 0
}

@test
func test_ternary_basic() -> I32 {
    let x: I32 = 10
    let y: I32 = 20

    let max: I32 = x > y ? x : y
    assert_eq(max, 20, "ternary should return larger value")

    let min: I32 = x < y ? x : y
    assert_eq(min, 10, "ternary should return smaller value")

    return 0
}

@test
func test_ternary_nested() -> I32 {
    let a: I32 = 5
    let b: I32 = 10
    let c: I32 = 15

    // Nested ternary: find max of three numbers
    let max: I32 = a > b ? (a > c ? a : c) : (b > c ? b : c)
    assert_eq(max, 15, "nested ternary should find max of three")

    return 0
}

@test
func test_ternary_with_expressions() -> I32 {
    let x: I32 = 5

    // Ternary with arithmetic expressions
    let result: I32 = x > 3 ? x * 2 : x + 10
    assert_eq(result, 10, "ternary should evaluate true branch (5*2)")

    let result2: I32 = x < 3 ? x * 2 : x + 10
    assert_eq(result2, 15, "ternary should evaluate false branch (5+10)")

    return 0
}

@test
func test_while_and_ternary_combined() -> I32 {
    let mut i: I32 = 0
    let mut evens: I32 = 0
    let mut odds: I32 = 0

    while i < 10 {
        // Use ternary to decide which counter to increment
        let is_even: Bool = i % 2 == 0
        evens = is_even ? evens + 1 : evens
        odds = is_even ? odds : odds + 1
        i = i + 1
    }

    assert_eq(evens, 5, "should count 5 even numbers (0,2,4,6,8)")
    assert_eq(odds, 5, "should count 5 odd numbers (1,3,5,7,9)")

    return 0
}
