use test
use std::time::Instant

// ============ Basic Time Functions ============

@test
func test_time_ns() -> I32 {
    let start = Instant::now()
    // Just verify the function runs and returns a value
    let ns = start.as_nanos()
    let check: Bool = ns == ns
    assert(check, "time_ns should return a value")
    return 0
}

// ============ Time Monotonicity ============

@test
func test_time_monotonic() -> I32 {
    let t1 = Instant::now()

    // Do some work
    let mut sum: I32 = 0
    let mut i: I32 = 0
    loop (i < 100) {
        sum = sum + i
        i = i + 1
    }

    let t2 = Instant::now()
    let diff = t2.as_nanos() - t1.as_nanos()
    assert(diff >= 0, "time should be monotonic")
    return 0
}

// ============ Duration Calculation ============

@test
func test_elapsed_time() -> I32 {
    let start = Instant::now()

    // Do some work
    let mut product: I32 = 1
    let mut i: I32 = 1
    loop (i <= 10) {
        product = product * i
        i = i + 1
    }

    let elapsed = start.elapsed()
    let nanos = elapsed.as_nanos()
    assert(nanos >= 0, "elapsed time should be non-negative")
    return 0
}

// ============ Time Comparison ============

@test
func test_time_comparison() -> I32 {
    let t1 = Instant::now()
    let t2 = Instant::now()

    let diff = t2.as_nanos() - t1.as_nanos()
    assert(diff >= 0, "later time should be >= earlier time")
    return 0
}
