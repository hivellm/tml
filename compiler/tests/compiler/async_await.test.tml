// Test async/await type checking and execution
use test::*

// Simple async function
async func async_simple() -> I64 {
    return 42
}

// Async function that calls another async function (postfix .await style)
async func async_chain_postfix() -> I64 {
    let result: I64 = async_simple().await
    return result + 1
}

// Async function that calls another async function (prefix await style)
async func async_chain_prefix() -> I64 {
    let result: I64 = await async_simple()
    return result + 1
}

// Async function with multiple awaits (mixed styles)
async func async_multiple() -> I64 {
    let a: I64 = async_simple().await
    let b: I64 = await async_simple()
    return a + b
}

// Async function with computation
async func async_compute(x: I64) -> I64 {
    return x * 2 + 10
}

@test
func test_async_simple() {
    // Test block_on with simple async function
    let result: I64 = block_on(async_simple())
    assert_eq(result, 42)
}

@test
func test_async_chain_postfix() {
    // Test chained async with postfix .await
    let result: I64 = block_on(async_chain_postfix())
    assert_eq(result, 43)
}

@test
func test_async_chain_prefix() {
    // Test chained async with prefix await
    let result: I64 = block_on(async_chain_prefix())
    assert_eq(result, 43)
}

@test
func test_async_multiple() {
    // Test multiple awaits
    let result: I64 = block_on(async_multiple())
    assert_eq(result, 84)
}

@test
func test_async_with_args() {
    // Test async function with arguments
    let result: I64 = block_on(async_compute(5))
    assert_eq(result, 20)
}
